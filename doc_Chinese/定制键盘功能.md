## 1.  添加内置词典

1.将需要内置的词典和配置文件添加至assets目录下。词典和配置文件请联系zengine@nlptech.com获取。  
2.在工程App 对应build.gradle添加配置，如下：  
**build.gradle**

~~~
aaptOptions{
           noCompress 'xz'
}
~~~

## 2. Theme设定

通过调用**Agent.getInstance().addExternalThemes(context, infos)**来新增主题。  
通过调用**Agent.getInstance().deleteExternalThemes(context, infos)**来删除主题。  
通过调用**Agent.getInstance().getExternalThemes(context)**来取得新增的主题。  
通过调用**Agent.getInstance().loadTheme(context,externalId)**来应用主题。  

示例，新增一个主题  
**ExampleApplication.java:**

~~~java
public class ExampleApplication extends Application {
        @Override
        public void onCreate() {
                super.onCreate();
                … … … … …
                addExternalTheme()
                Agent.getInstance().loadTheme(this,"my external theme id")
                … … … … …
        }  

    private void addExternalTheme() {
        Drawable keyboardBackgroundDrawable = ContextCompat.getDrawable(this, R.drawable.test_theme_keyboard_bg);

        StateListDrawable keyBackgroundDrawable = new StateListDrawable();
        keyBackgroundDrawable.addState(new int[]{android.R.attr.state_pressed}, ContextCompat.getDrawable(this, R.drawable.test_theme_key_press));
        keyBackgroundDrawable.addState(new int[]{}, ContextCompat.getDrawable(this, R.drawable.test_theme_key_normal));

        StateListDrawable functionKeyBackgroundDrawable = new StateListDrawable();
        functionKeyBackgroundDrawable.addState(new int[]{android.R.attr.state_pressed}, ContextCompat.getDrawable(this, R.drawable.test_theme_function_key_press));
        functionKeyBackgroundDrawable.addState(new int[]{}, ContextCompat.getDrawable(this, R.drawable.test_theme_function_key_normal));

        StateListDrawable spacebarBackgroundDrawable = new StateListDrawable();
        spacebarBackgroundDrawable.addState(new int[]{android.R.attr.state_pressed}, ContextCompat.getDrawable(this, R.drawable.test_theme_space_key_press));
        spacebarBackgroundDrawable.addState(new int[]{}, ContextCompat.getDrawable(this, R.drawable.test_theme_space_key_normal));

        ExternalThemeInfo externalThemeInfo = new ExternalThemeInfo.Builder("my external theme id", "Test Theme")
                .setKeyboardBackground(keyboardBackgroundDrawable)
                .setKeyBackground(keyBackgroundDrawable)
                .setFunctionKeyBackground(functionKeyBackgroundDrawable)
                .setSpacebarBackground(spacebarBackgroundDrawable)
                .setKeyLetterSizeRatio(0.4f)
                .setKeyTextColor(Color.RED)
                .setKeyHintLetterColor(Color.BLUE)
                .setFunctionKeyTextColor(Color.YELLOW)
                .setGestureTrailColor(Color.BLACK)
                .build();
        Agent.getInstance().addExternalThemes(this, externalThemeInfo);
    }
… … … … …
~~~
## 3. 定制EmojiView

如果开发者想自己实现Emoji的展示，而不用KeyboardView中集成的EmojiView，可通过在 onDisplayEmojiKeyboard()中展示自定义的EmojiView来实现，同时返回true。

## 4.  定制NeutralStrip及SuggestionStripView

集成方extends ZengineInputMethodService之后, Zengine提供方法可自定义NeutralStrip及SuggestionStripView。

### NeutralStrip

针对键盘未显示候选词区时的展示条。

示例 :

**input_view.xml:**

~~~java
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    style="?attr/inputViewStyle">

    <FrameLayout
        android:id="@+id/kb_container"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"/>

	// 添加自定义的Neutral Strip
    <RelativeLayout
        android:id="@+id/customized_strip"
        android:layout_width="match_parent"
        android:layout_height="@dimen/config_suggestions_strip_height"
        android:layout_alignTop="@id/kb_container"
        android:layoutDirection="ltr"
        android:background="@android:color/black">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:textStyle="bold"
            android:text="Customized Strip"
            android:textColor="@android:color/white"/>

    </RelativeLayout>

</RelativeLayout>
~~~

**LatinIME.java:**


~~~java
	// 集成方override并且显示自定义NeutralStrip, 
	// 预设的NeutralStrip将不会显示并且让集成方控制
	@Override
    public void onHideCustomizedNeutralStripView() {
        // 隐藏自定义NeutralStrip
        mCustomizedStrip.setVisibility(View.GONE);
    }

    @Override
    public void onShowCustomizedNeutralStripView() {
        // 显示自定义NeutralStrip
        mCustomizedStrip.setVisibility(View.VISIBLE);
    }

~~~ 


### SuggestionStripView

SuggestionStripView类作为候选词栏, Zengine支持預設SuggestionStripView的设置以及操作
。 
集成方需自订 View 并且
extends com.nlptech.keyboardview.suggestions.SuggestionStripView, 制作自定义画面, 并且需实作两个抽象方法：
##### setSuggestionStripViewListener() : 
传入SuggestionStripViewListener, listner包含pickSuggestionManually方法会接回原生LatinIME中的pickSuggestionManually

##### setSuggestions() : 
传入候选词

示例 :  

**CustomizedSuggestStripView.java:**

~~~java
public class CustomizedSuggestStripView extends SuggestionStripView {
	… … … …
	@Override
    public void setSuggestionStripViewListener(final SuggestionStripViewListener listener, final View inputView) {
    	/ /实作相关行为
    }
	… … … …
	@Override
    public void setSuggestions(final SuggestedWords suggestedWords, final boolean isRtlLanguage) {
	    // 实作相关行为
    }
    … … … …
}

~~~

**LatinIME.java:**

~~~java
	// 集成方override并且回传自定义候选词区的View
	@Override
    public SuggestionStripView getSuggestionView() {
    	// 回传集成方自定义候选词区的View
    	return new CustomizedSuggestStripView(getContext());
    }
~~~


ZengineInputMethodService提供showSuggestionView() / hideSuggestionView(), 可供集成方自行控制SuggestStripView的显示/隐藏 

## 5.  输入事件回调

**LatinIME.java:**

~~~java
	  … … … … …
      public void onCreate() {
          DebugFlags.init(PreferenceManager.getDefaultSharedPreferences(this));
          RichInputMethodManager.init(this);
          mRichImm = RichInputMethodManager.getInstance();
          Agent.getInstance().onCreate(this, mInputLogic, new LanguageCallback() {
              @Override
              public void onIMELanguageChanged(InputMethodSubtype subtype) {
                  onCurrentInputMethodSubtypeChanged(subtype);
              }
          });
   

          //设置输入事件回调 (可选)
          Agent.getInstance().setUserInputCallback(
              new IUserInputCallback() {
					@Override
					public void onUserTyping(String wordComposing) { }
					@Override
					public void onUserTyped(String text) { }
					@Override
					public void onTextChanged(int direction) { }
          });

      }
~~~
